(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{221:function(t,e,n){"use strict";n.r(e);var r={name:"CardComponent",props:{title:{type:String,default:null},icon:{type:String,default:null},headerIcon:{type:String,default:null}},methods:{headerIconClick:function(){this.$emit("header-icon-click")}}},l=n(22),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[t.title?n("header",{staticClass:"card-header"},[n("p",{staticClass:"card-header-title"},[t.icon?n("b-icon",{attrs:{icon:t.icon,"custom-size":"default"}}):t._e(),t._v("\n      "+t._s(t.title)+"\n    ")],1),t._v(" "),t.headerIcon?n("a",{staticClass:"card-header-icon",attrs:{href:"#","aria-label":"more options"},on:{click:function(e){return e.preventDefault(),t.headerIconClick(e)}}},[n("b-icon",{attrs:{icon:t.headerIcon,"custom-size":"default"}})],1):t._e()]):t._e(),t._v(" "),n("div",{staticClass:"card-content"},[t._t("default")],2)])}),[],!1,null,null,null);e.default=component.exports},222:function(t,e,n){"use strict";n.r(e);n(228);var r=n(221),l={name:"CardWidget",components:{GrowingNumber:n(225).default,CardComponent:r.default},props:{description:{type:String,default:""},icon:{type:String,default:null},number:{type:Number,default:0},prefix:{type:String,default:null},suffix:{type:String,default:null},label:{type:String,default:null},type:{type:String,default:null}}},o=n(22),component=Object(o.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("card-component",[n("div",{staticClass:"level"},[n("div",{staticClass:"level-item"},[n("div",{staticClass:"is-widget-label"},[n("h3",{staticClass:"subtitle is-spaced is-size-6-touch"},[t._v("\n                    "+t._s(t.label)+"\n                    "),n("b-tooltip",{attrs:{label:t.description,type:"is-light",position:"is-top",active:t.active}},[n("sup",[n("b-icon",{attrs:{icon:"help-circle-outline",size:"is-small",type:"is-grey"}})],1)])],1),t._v(" "),n("h1",{staticClass:"title is-size-5-touch"},[n("growing-number",{attrs:{value:t.number,prefix:t.prefix,suffix:t.suffix}})],1)]),t._v(" "),t.icon?n("div",{staticClass:"level-item has-widget-icon"},[n("div",{staticClass:"is-widget-icon"},[n("b-icon",{attrs:{icon:t.icon,size:"is-large",type:t.type}})],1)]):t._e()])])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{GrowingNumber:n(225).default,CardComponent:n(221).default})},223:function(t,e,n){"use strict";n.r(e);var r={extends:n(226).c,props:["chartData","options"],methods:{},mounted:function(){this.renderChart(this.chartData,this.options)}},l=n(22),component=Object(l.a)(r,void 0,void 0,!1,null,null,null);e.default=component.exports},224:function(t,e,n){"use strict";n.r(e);var r={extends:n(226).d,props:["chartData","options"],methods:{},mounted:function(){this.renderChart(this.chartData,this.options)}},l=n(22),component=Object(l.a)(r,void 0,void 0,!1,null,null,null);e.default=component.exports},225:function(t,e,n){"use strict";n.r(e);n(228),n(56);var r=n(365),l=n.n(r),o={name:"GrowingNumber",props:{prefix:{type:String,default:null},suffix:{type:String,default:null},value:{type:Number,default:0},duration:{type:Number,default:500}},data:function(){return{newValue:0,step:0}},computed:{newValueFormatted:function(){return this.newValue<1e3?this.newValue:l()(this.newValue).format("0,0")}},watch:{value:function(){this.growInit()}},mounted:function(){this.growInit()},methods:{growInit:function(){var t=this.value/(this.duration/25);this.grow(t)},grow:function(t){var e=this,n=Math.ceil(this.newValue+t);if(n>this.value)return this.newValue=this.value,!1;this.newValue=n,setTimeout((function(){e.grow(t)}),25)}}},c=n(22),component=Object(c.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v(this._s(this.prefix)+this._s(this.newValueFormatted)+this._s(this.suffix))])}),[],!1,null,null,null);e.default=component.exports},227:function(t,e,n){"use strict";var base="https://fm7tv6fq08.execute-api.ap-southeast-1.amazonaws.com/dev";e.a={BASE:base,TABLEVISION:"/tables",TABLEVISIONSTATS:"/stats",RFIDFSRVISIO:"/rfid_fsr",RFIDTRAYINOUT:"/tray_in_out",RFIDTRAYIN:"/tray_in",RETURNDISTRVISION:"/g6trayreturndistr",STALLTOTALVISION:"/g6total",BARCHART:"/g6barchart",G6OVERVIEW:"/g6overview",OVERVIEW2:"/overview2",OVERVIEW:"/overview/tray_return"}},366:function(t,e,n){var map={"./af":229,"./af.js":229,"./ar":230,"./ar-dz":231,"./ar-dz.js":231,"./ar-kw":232,"./ar-kw.js":232,"./ar-ly":233,"./ar-ly.js":233,"./ar-ma":234,"./ar-ma.js":234,"./ar-sa":235,"./ar-sa.js":235,"./ar-tn":236,"./ar-tn.js":236,"./ar.js":230,"./az":237,"./az.js":237,"./be":238,"./be.js":238,"./bg":239,"./bg.js":239,"./bm":240,"./bm.js":240,"./bn":241,"./bn-bd":242,"./bn-bd.js":242,"./bn.js":241,"./bo":243,"./bo.js":243,"./br":244,"./br.js":244,"./bs":245,"./bs.js":245,"./ca":246,"./ca.js":246,"./cs":247,"./cs.js":247,"./cv":248,"./cv.js":248,"./cy":249,"./cy.js":249,"./da":250,"./da.js":250,"./de":251,"./de-at":252,"./de-at.js":252,"./de-ch":253,"./de-ch.js":253,"./de.js":251,"./dv":254,"./dv.js":254,"./el":255,"./el.js":255,"./en-au":256,"./en-au.js":256,"./en-ca":257,"./en-ca.js":257,"./en-gb":258,"./en-gb.js":258,"./en-ie":259,"./en-ie.js":259,"./en-il":260,"./en-il.js":260,"./en-in":261,"./en-in.js":261,"./en-nz":262,"./en-nz.js":262,"./en-sg":263,"./en-sg.js":263,"./eo":264,"./eo.js":264,"./es":265,"./es-do":266,"./es-do.js":266,"./es-mx":267,"./es-mx.js":267,"./es-us":268,"./es-us.js":268,"./es.js":265,"./et":269,"./et.js":269,"./eu":270,"./eu.js":270,"./fa":271,"./fa.js":271,"./fi":272,"./fi.js":272,"./fil":273,"./fil.js":273,"./fo":274,"./fo.js":274,"./fr":275,"./fr-ca":276,"./fr-ca.js":276,"./fr-ch":277,"./fr-ch.js":277,"./fr.js":275,"./fy":278,"./fy.js":278,"./ga":279,"./ga.js":279,"./gd":280,"./gd.js":280,"./gl":281,"./gl.js":281,"./gom-deva":282,"./gom-deva.js":282,"./gom-latn":283,"./gom-latn.js":283,"./gu":284,"./gu.js":284,"./he":285,"./he.js":285,"./hi":286,"./hi.js":286,"./hr":287,"./hr.js":287,"./hu":288,"./hu.js":288,"./hy-am":289,"./hy-am.js":289,"./id":290,"./id.js":290,"./is":291,"./is.js":291,"./it":292,"./it-ch":293,"./it-ch.js":293,"./it.js":292,"./ja":294,"./ja.js":294,"./jv":295,"./jv.js":295,"./ka":296,"./ka.js":296,"./kk":297,"./kk.js":297,"./km":298,"./km.js":298,"./kn":299,"./kn.js":299,"./ko":300,"./ko.js":300,"./ku":301,"./ku.js":301,"./ky":302,"./ky.js":302,"./lb":303,"./lb.js":303,"./lo":304,"./lo.js":304,"./lt":305,"./lt.js":305,"./lv":306,"./lv.js":306,"./me":307,"./me.js":307,"./mi":308,"./mi.js":308,"./mk":309,"./mk.js":309,"./ml":310,"./ml.js":310,"./mn":311,"./mn.js":311,"./mr":312,"./mr.js":312,"./ms":313,"./ms-my":314,"./ms-my.js":314,"./ms.js":313,"./mt":315,"./mt.js":315,"./my":316,"./my.js":316,"./nb":317,"./nb.js":317,"./ne":318,"./ne.js":318,"./nl":319,"./nl-be":320,"./nl-be.js":320,"./nl.js":319,"./nn":321,"./nn.js":321,"./oc-lnc":322,"./oc-lnc.js":322,"./pa-in":323,"./pa-in.js":323,"./pl":324,"./pl.js":324,"./pt":325,"./pt-br":326,"./pt-br.js":326,"./pt.js":325,"./ro":327,"./ro.js":327,"./ru":328,"./ru.js":328,"./sd":329,"./sd.js":329,"./se":330,"./se.js":330,"./si":331,"./si.js":331,"./sk":332,"./sk.js":332,"./sl":333,"./sl.js":333,"./sq":334,"./sq.js":334,"./sr":335,"./sr-cyrl":336,"./sr-cyrl.js":336,"./sr.js":335,"./ss":337,"./ss.js":337,"./sv":338,"./sv.js":338,"./sw":339,"./sw.js":339,"./ta":340,"./ta.js":340,"./te":341,"./te.js":341,"./tet":342,"./tet.js":342,"./tg":343,"./tg.js":343,"./th":344,"./th.js":344,"./tk":345,"./tk.js":345,"./tl-ph":346,"./tl-ph.js":346,"./tlh":347,"./tlh.js":347,"./tr":348,"./tr.js":348,"./tzl":349,"./tzl.js":349,"./tzm":350,"./tzm-latn":351,"./tzm-latn.js":351,"./tzm.js":350,"./ug-cn":352,"./ug-cn.js":352,"./uk":353,"./uk.js":353,"./ur":354,"./ur.js":354,"./uz":355,"./uz-latn":356,"./uz-latn.js":356,"./uz.js":355,"./vi":357,"./vi.js":357,"./x-pseudo":358,"./x-pseudo.js":358,"./yo":359,"./yo.js":359,"./zh-cn":360,"./zh-cn.js":360,"./zh-hk":361,"./zh-hk.js":361,"./zh-mo":362,"./zh-mo.js":362,"./zh-tw":363,"./zh-tw.js":363};function r(t){var e=l(t);return n(e)}function l(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}r.keys=function(){return Object.keys(map)},r.resolve=l,t.exports=r,r.id=366},370:function(t,e,n){"use strict";n.r(e);n(158),n(15),n(28),n(56);var r=n(222),l=n(221),o=(n(223),n(227)),c=(n(224),{components:{CardWidget:r.default,CardComponent:l.default},watch:{date:function(){this.fetchStatsByHour()},hourlyStats:function(){this.$refs.tablevisionChart.renderChart(this.tablevisionChartData)},didTriggerAPI:function(){this.didTriggerAPI?this.startAPIPolling(!0):(this.tableVisionAPIStatus="Offline",this.startAPIPolling(!1))}},data:function(){var t=new Date;return{didTriggerAPI:!1,tableVisionAPIStatus:"Offline",tables:[],selfReturnsPercentage:0,cleanerReturnPercentage:0,peakLazyReturns:0,totalOccupancy:0,maxLazyHour:6,ampm:"am",timing:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],lazyHour:6,hourlyStats:[],date:new Date,minDate:new Date(t.getFullYear()-80,t.getMonth(),t.getDate()),maxDate:new Date(t.getFullYear()+18,t.getMonth(),t.getDate()),tablevisionChartData:{labels:["06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00"],datasets:[{label:"Cleaner returns",BackgroundColor:"white",borderWidth:3,borderColor:"#ef4250",pointBorderColor:"#249EBF",data:[]},{label:"Self returns",BackgroundColor:"white",borderWidth:3,borderColor:"#7AD7F0",pointBorderColor:"#7AD7F0",data:[]}]},datasets:[{label:"Cleaner returns",BackgroundColor:"white",borderWidth:3,borderColor:"#ef4250",pointBorderColor:"#249EBF",data:[]},{label:"Self returns",BackgroundColor:"white",borderWidth:3,borderColor:"#7AD7F0",pointBorderColor:"#7AD7F0",data:[]}]}},mounted:function(){this.fetchStatsByHour()},methods:{indexOfMax:function(t){if(0===t.length)return-1;for(var e=t[0],n=0,i=1;i<t.length;i++)t[i]>e&&(n=i,e=t[i]);return n},startAPIPolling:function(t){var e=this;t?(this.fetchTableVacancy(),this.interval=setInterval((function(){e.fetchTableVacancy(),e.fetchTotalStats()}),1e3)):clearInterval(this.interval)},fetchTotalStats:function(){var t=this,e=this.getStringFormattedDate(this.date);this.$axios.get(o.a.BASE+o.a.TABLEVISIONSTATS+"/"+e.toString()).then((function(e){var data=e.data;t.selfReturnsPercentage=data.self,t.cleanerReturnPercentage=data.cleaner,t.totalOccupancy=data.total,t.maxLazyHour=t.indexOfMax(t.tablevisionChartData.datasets[0].data),t.maxLazyHour>=6&&(t.ampm="pm"),t.lazyHour=t.timing[t.maxLazyHour]})).catch((function(e){if(t.selfReturnsPercentage=0,t.cleanerReturnPercentage=0,t.totalOccupancy=0,null!=e.response){var n=e.response.data;t.toastAlert(n.message,"is-danger",5e3),console.log("table stats "+n.message)}else"Offline"!=t.tableVisionAPIStatus&&(t.toastAlert(e,"is-danger",5e3),console.log("table stats "+e))}))},fetchStatsByHour:function(){var t=this;this.tablevisionChartData.datasets[0].data=[],this.tablevisionChartData.datasets[1].data=[];var e=this.getStringFormattedDate(this.date);this.$axios.get(o.a.BASE+o.a.TABLEVISIONSTATS+"/per_hour/"+e).then((function(e){var n=new Object(e.data);for(var r in t.hourlyStats=n,n)0!=n[r].total&&(t.tablevisionChartData.datasets[0].data.push(n[r].true_cleaner_count),t.tablevisionChartData.datasets[1].data.push(n[r].true_self_count));t.maxLazyHour=t.indexOfMax(t.tablevisionChartData.datasets[0].data),t.maxLazyHour>=6&&(t.ampm="pm"),t.lazyHour=t.timing[t.maxLazyHour]})).catch((function(e){if(t.tableVisionAPIStatus="Offline",t.tables=[],null!=e.response){var n=e.response.data;t.toastAlert(n.message,"is-danger",5e3),console.log("table vision stats hourly "+n.message)}else t.toastAlert(e,"is-danger",5e3),console.log("table vision stats hour"+e)}))},getTodayDate:function(){function t(s){return s<10?"0"+s:s}var e=new Date;return[t(e.getDate()),t(e.getMonth()+1),e.getFullYear()].join("-")},getStringFormattedDate:function(t){function e(s){return s<10?"0"+s:s}var n=t;return[e(n.getDate()),e(n.getMonth()+1),n.getFullYear()].join("-")},fetchTableVacancy:function(){var t=this;this.$axios.get(o.a.BASE+o.a.TABLEVISION).then((function(e){var data=e.data;t.tables=data.tables,t.tableVisionAPIStatus="LIVE"})).catch((function(e){if(t.tableVisionAPIStatus="Offline",t.tables=[],null!=e.response){var n=e.response.data;t.toastAlert(n.message,"is-danger",5e3),console.log("table vision "+n.message)}else"Offline"!=t.tableVisionAPIStatus&&(t.toastAlert(e,"is-danger",5e3),console.log("table vision "+e))}))}}}),d=n(22),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"section"},[n("p",{staticClass:"title"},[t._v("Tablevision data")]),t._v(" "),n("small",{staticClass:"subtitle has-text-grey"},[t._v("Monitor occupancy status and self-returns/cleaner-returns with automated object detection through the Google Cloud Vision API.")]),t._v(" "),n("div",{staticClass:"columns is-vcentered my-5"},[n("div",{staticClass:"column is-5"},[n("div",{staticClass:"card has-background-info-light"},[n("div",{staticClass:"card-content"},[n("p",{staticClass:"title"},[t._v("Occupancy vs Self-Returns")]),t._v(" "),n("b-field",{attrs:{label:"Select a date"}},[n("b-datepicker",{attrs:{placeholder:"Click to select...","min-date":t.minDate,"max-date":t.maxDate},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),n("line-chart",{ref:"tablevisionChart",attrs:{chartData:this.tablevisionChartData}})],1)])]),t._v(" "),n("div",{staticClass:"column is-7"},[n("div",{staticClass:"card has-background-primary-light mb-5"},[n("div",{staticClass:"card-content"},[n("p",{staticClass:"title"},[t._v("Table occupancy")]),t._v(" "),n("p",{staticClass:"has-text-weight-bold"},[t._v("\n                        API Status:\n                        "),n("span",{class:"LIVE"==t.tableVisionAPIStatus?"has-text-success":"has-text-danger"},[t._v(t._s(this.tableVisionAPIStatus))])]),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"field"},[n("b-switch",{model:{value:t.didTriggerAPI,callback:function(e){t.didTriggerAPI=e},expression:"didTriggerAPI"}},[t._v("\n                            Start API\n                        ")])],1),t._v(" "),t._l(t.tables,(function(e){return n("b-tag",{key:e.table,staticClass:"my-2 mx-2",attrs:{type:0==e.state?"is-success":1==e.state?"is-warning":"is-danger",size:"is-large",id:e.table}},[n("p",{staticClass:"has-text-weight-bold"},[t._v(t._s(e.table))])])})),t._v(" "),n("br"),t._v(" "),n("p",{staticClass:"subtitle has-text-left mt-5"},[t._v("Legend")]),t._v(" "),n("b-tag",{attrs:{type:"is-success",size:"is-small"}},[n("p",[t._v("Vacant")])]),t._v(" "),n("b-tag",{attrs:{type:"is-warning",size:"is-small"}},[n("p",[t._v("Vacant but uncleared")])]),t._v(" "),n("b-tag",{attrs:{type:"is-danger",size:"is-small"}},[n("p",[t._v("Occupied")])])],2)]),t._v(" "),n("div",{staticClass:"tile is-ancestor"},[n("div",{staticClass:"tile is-vertical is-block-tablet"},[n("div",{staticClass:"tile is-parent is-vertical"},[n("card-widget",{staticClass:"tile is-child notification has-background-success-light",attrs:{type:"is-dark",icon:"charity",number:this.selfReturnsPercentage,suffix:"%",label:"Self-returns rate today",description:"Percentage of patrons who cleaned up their tables after eating today"}}),t._v(" "),n("card-widget",{staticClass:"tile is-child notification has-background-danger-light",attrs:{type:"is-dark",icon:"silverware-clean",number:this.cleanerReturnPercentage,suffix:"%",label:"Rate of tables cleared by cleaners today",description:"Tables cleared by cleaners today in percentage"}}),t._v(" "),n("card-widget",{staticClass:"tile is-child notification has-background-warning-light",attrs:{type:"is-dark",icon:"account-multiple-minus",number:this.lazyHour,suffix:this.ampm,label:"Peak lazy patron time",description:"Time when people self-returned trays least"}})],1)])])])])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{LineChart:n(223).default,CardWidget:n(222).default})}}]);